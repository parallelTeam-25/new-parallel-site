name: Deploy to Hostinger

on:
  push:
    branches: [ main ]
  workflow_dispatch:

jobs:
  deploy:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Test FTP Connection
      run: |
        sudo apt-get update
        sudo apt-get install -y ftp
        echo "Testing FTP connection..."
        ftp -n 195.35.27.36 <<EOF
        user u399412635.parallel-ai.it CWgbzff6os&o7]qA
        pwd
        ls
        quit
        EOF
    
    - name: Deploy with lftp (more reliable)
      run: |
        sudo apt-get install -y lftp
        lftp -c "
          set ssl:verify-certificate no;
          set ftp:passive-mode on;
          open -u u399412635.parallel-ai.it,CWgbzff6os&o7]qA 195.35.27.36;
          lcd ./;
          mirror -R -e -v --ignore-time --exclude .git/ --exclude .github/ --exclude README.md ./;
          quit
        "